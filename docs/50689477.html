
<!DOCTYPE html
  PUBLIC "" "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:whc="http://www.oxygenxml.com/webhelp/components" xml:lang="en-us" lang="en-us">
    <head><link rel="shortcut icon" href="favicon32x32.png"><!----></link><link rel="icon" href="favicon32x32.png"><!----></link><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="Unravel 4.0-4.1 Unravel 4.0-4.1 Installation Guide for Hortonworks Data Platform (HDP) Introduction This guide describes how to install the Unravel Sensor for Hive Hook and Spark on HDP 2.2.x-2.5.x ..." /><meta charset="UTF-8" /><meta name="copyright" content="(C) Copyright 2019" /><meta name="DC.rights.owner" content="(C) Copyright 2019" /><meta name="DC.Type" content="task" /><meta name="DC.Relation" scheme="URI" content="50688443.html" /><meta name="DC.Relation" scheme="URI" content="50672736.html" /><meta name="DC.Relation" scheme="URI" content="51213196.html" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="FAGIJEHH" /><meta name="DC.Language" content="en-us" /><title>Part 2: Enable Additional Data Collection / Instrumentation for HDP</title><!--  Generated with Oxygen version 20.1-SNAPSHOT, build number 2018122203.  --><meta name="wh-path2root" content="" /><meta name="wh-toc-id" content="FAGIJEHH-d66e165" /><link rel="stylesheet" type="text/css" href="./oxygen-webhelp/lib/bootstrap/css/bootstrap.min.css" /><link rel="stylesheet" href="./oxygen-webhelp/lib/bootstrap/css/bootstrap-theme.min.css" /><link rel="stylesheet" href="./oxygen-webhelp/lib/jquery-ui/jquery-ui.min.css" /><link rel="stylesheet" type="text/css" href="./oxygen-webhelp/app/topic-page.css?buildId=2018122203" /><script type="text/javascript" src="./oxygen-webhelp/lib/jquery/jquery-3.1.1.min.js"><!----></script><script data-main="./oxygen-webhelp/app/topic-page.js" src="./oxygen-webhelp/lib/requirejs/require.js"></script><link rel="stylesheet" type="text/css" href="oxygen-webhelp/template/green.css?buildId=2018122203" /></head>

    <body id="FAGIJEHH" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">Jump to main content</a>
        <!-- EXM-36950 - Expand the args.hdr parameter here -->
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div class="wh_header_flex_container">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <!--
                            This component will be generated when the next parameters are specified in the transformation scenario:
                            'webhelp.logo.image' and 'webhelp.logo.image.target.url'.
                            See: http://oxygenxml.com/doc/versions/17.1/ug-editor/#topics/dita_webhelp_output.html.
                    -->
                    <a href="https://unraveldata.com/" class=" wh_logo hidden-xs "><img src="C:\Users\five\Documents\unravel\demos\Oxygen\git\demo-oxygen\source\undocs\media\logo.png" alt="  Unravel 4.0-4.1  " /></a>
                    <div class=" wh_publication_title "><a href="index.html"><span class="booktitle">  <span class="ph mainbooktitle">Unravel 4.0-4.1</span>  </span></a></div>
                    
                </div>
                
                <!-- The menu button for mobile devices is copied in the output only when the 'webhelp.show.top.menu' parameter is set to 'yes' -->
                <button type="button" data-target="#wh_top_menu_and_indexterms_link" id="wh_menu_mobile_button" data-toggle="collapse" class="navbar-toggle collapsed wh_toggle_button" aria-expanded="false" aria-label="Toggle menu">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                <nav class=" wh_top_menu "><ul>
   <li><span data-tocid="Overview_53899450-d66e14" data-state="leaf" class=" topicref " data-id="Overview_53899450"><span class="title"><a href="Overview_53899450.html">Overview </a></span></span></li>
   <li class="has-children"><span data-tocid="installation-d66e26" data-state="not-ready" class=" topicref " data-id="installation"><span class="title"><a href="installation.html">Installation Guides</a></span></span></li>
   <li class="has-children"><span data-tocid="User-Guide_50687944-d66e182" data-state="not-ready" class=" topicref " data-id="User-Guide_50687944"><span class="title"><a href="User-Guide_50687944.html">User Guide </a></span></span></li>
   <li><span data-tocid="Unravel-Server-Reference_50690507-d66e269" data-state="leaf" class=" topicref " data-id="Unravel-Server-Reference_50690507"><span class="title"><a href="Unravel-Server-Reference_50690507.html">Unravel Server Reference </a></span></span></li>
   <li class="has-children"><span data-tocid="Advanced-Topics_50688158-d66e282" data-state="not-ready" class=" topicref " data-id="Advanced-Topics_50688158"><span class="title"><a href="Advanced-Topics_50688158.html">Advanced Topics </a></span></span></li>
   <li class="has-children"><span data-tocid="FDJAAABA-d66e494" data-state="not-ready" class=" topicref " data-id="FDJAAABA"><span class="title"><a href="53900010.html">Release Notes</a></span></span></li>
</ul></nav>
                
                
            </div>
        </div>
    </div>
</header>
        
        <div class=" wh_search_input "><form id="searchForm" method="get" role="search" action="search.html"><div><input type="search" placeholder="Search " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="Search query" /><button type="submit" class="wh_search_button" aria-label="Search"><span>Search</span></button></div><script><!--
                                    $(document).ready(function () {
                                        $('#searchForm').submit(function (e) {
                                            if ($('.wh_search_textfield').val().length < 1) {
                                                e.preventDefault();
                                            }
                                        });
                                    });
                                --></script></form></div>
        
        <div class="container-fluid">
            <div class="row">

                <nav class="wh_tools hidden-print">
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol xmlns:html="http://www.w3.org/1999/xhtml" class="hidden-print"><li><span class="home"><a href="index.html"><span>Home</span></a></span></li>
   <li><span class="topicref" data-id="installation"><span class="title"><a href="installation.html">Installation Guides</a><span class="wh-tooltip">
               
               <p xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:toc="http://www.oxygenxml.com/ns/webhelp/toc" class="shortdesc">Find installation steps for your platform.</p>
               </span></span></span></li>
   <li><span class="topicref" data-id="FAGIIEED"><span class="title"><a href="50688443.html">Installation Guide for Hortonworks Data Platform (HDP) </a></span></span></li>
   <li class="active"><span class="topicref" data-id="FAGIJEHH"><span class="title"><a href="50689477.html">Part 2: Enable Additional Data Collection / Instrumentation for HDP </a></span></span></li>
</ol></div>

                    <div class="wh_right_tools hidden-sm hidden-xs">
                        <div class=" wh_navigation_links "><span id="topic_navigation_links" class="navheader">
  
<span class="navprev"><a class="link" href="50672736.html" title="Part 1: Install Unravel Server on HDP" aria-label="Previous topic: Part 1: Install Unravel Server on HDP" rel="prev"></a></span>  
<span class="navnext"><a class="link" href="51213196.html" title="Part 3: Additional Topics for HDP" aria-label="Next topic: Part 3: Additional Topics for HDP" rel="next"></a></span>  </span></div>
                        <button class="wh_hide_highlight" aria-label="Toggle search highlights" title="Toggle search highlights"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="Collapse sections" title="Collapse sections"></button>
                        <div class=" wh_print_link print "><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div>
                    </div>
                </nav>
            </div>

            <div class="wh_content_area">
                <div class="row">
                    
                        <nav role="navigation" id="wh_publication_toc" class="col-lg-3 col-md-3 col-sm-3 hidden-xs navbar hidden-print">
                            <div class=" wh_publication_toc " data-tooltip-position="right"><ul role="tree" aria-label="Table of Contents"><span class="expand-button-action-labels"><span id="button-expand-action" aria-label="Expand"></span><span id="button-collapse-action" aria-label="Collapse"></span><span id="button-pending-action" aria-label="Pending"></span></span><li role="treeitem" aria-expanded="true"><span data-tocid="installation-d66e26" class="topicref" data-id="installation" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action installation-d66e26-link" class="wh-expand-btn"></span><span class="title"><a href="installation.html" id="installation-d66e26-link">Installation Guides</a><span class="wh-tooltip">
               
               <p xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:toc="http://www.oxygenxml.com/ns/webhelp/toc" class="shortdesc">Find installation steps for your platform.</p>
               </span></span></span><ul role="group" class="nav nav-list"><span class="expand-button-action-labels"><span id="button-expand-action" aria-label="Expand"></span><span id="button-collapse-action" aria-label="Collapse"></span><span id="button-pending-action" aria-label="Pending"></span></span><li role="treeitem" aria-expanded="false"><span data-tocid="FAGIICFE-d66e37" class="topicref" data-id="FAGIICFE" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action FAGIICFE-d66e37-link" class="wh-expand-btn"></span><span class="title"><a href="50688254.html" id="FAGIICFE-d66e37-link">Installation Guide for Cloudera Distribution Including Apache Hadoop (CDH), with Cloudera Manager (CM) </a></span></span></li>
         <li role="treeitem" aria-expanded="false"><span data-tocid="Installation-Guide-for-MapR_50961894-d66e69" class="topicref" data-id="Installation-Guide-for-MapR_50961894" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action Installation-Guide-for-MapR_50961894-d66e69-link" class="wh-expand-btn"></span><span class="title"><a href="Installation-Guide-for-MapR_50961894.html" id="Installation-Guide-for-MapR_50961894-d66e69-link">Installation Guide for MapR </a></span></span></li>
         <li role="treeitem" aria-expanded="false"><span data-tocid="FAGIIGCH-d66e101" class="topicref" data-id="FAGIIGCH" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action FAGIIGCH-d66e101-link" class="wh-expand-btn"></span><span class="title"><a href="50688627.html" id="FAGIIGCH-d66e101-link">Installation Guide for Amazon Elastic MapReduce (Amazon EMR) and Qubole Clusters </a></span></span></li>
         <li role="treeitem" aria-expanded="true"><span data-tocid="FAGIIEED-d66e149" class="topicref" data-id="FAGIIEED" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action FAGIIEED-d66e149-link" class="wh-expand-btn"></span><span class="title"><a href="50688443.html" id="FAGIIEED-d66e149-link">Installation Guide for Hortonworks Data Platform (HDP) </a></span></span><ul role="group" class="nav nav-list"><span class="expand-button-action-labels"><span id="button-expand-action" aria-label="Expand"></span><span id="button-collapse-action" aria-label="Collapse"></span><span id="button-pending-action" aria-label="Pending"></span></span><li role="treeitem"><span data-tocid="FAGHCHDG-d66e157" class="topicref" data-id="FAGHCHDG" data-state="leaf"><span role="button" class="wh-expand-btn"></span><span class="title"><a href="50672736.html" id="FAGHCHDG-d66e157-link">Part 1: Install Unravel Server on HDP </a></span></span></li>
               <li role="treeitem" class="active"><span data-tocid="FAGIJEHH-d66e165" class="topicref" data-id="FAGIJEHH" data-state="leaf"><span role="button" class="wh-expand-btn"></span><span class="title"><a href="50689477.html" id="FAGIJEHH-d66e165-link">Part 2: Enable Additional Data Collection / Instrumentation for HDP </a></span></span></li>
               <li role="treeitem"><span data-tocid="FBCBDBJG-d66e173" class="topicref" data-id="FBCBDBJG" data-state="leaf"><span role="button" class="wh-expand-btn"></span><span class="title"><a href="51213196.html" id="FBCBDBJG-d66e173-link">Part 3: Additional Topics for HDP </a></span></span></li>
            </ul>
         </li>
      </ul>
   </li>
</ul></div>
                        </nav>
                    
                    
                    <div class="col-lg-9 col-md-9 col-sm-9 col-xs-12" id="wh_topic_body">
                        <div class=" wh_topic_content body "><main role="main"><article role="article" aria-labelledby="ariaid-title1">
   <h1 class="title topictitle1" id="ariaid-title1">Part 2: Enable Additional Data Collection / Instrumentation for HDP </h1>
   <div class="body taskbody">
      <section class="section context">
         <ol class="ol">

            <li class="li first">
               <span class="ph">
                  <a class="xref" href="index.html">Unravel 4.0-4.1</a>
               </span>
            </li>

            <li class="li">
               <span class="ph">
                  <a class="xref" href="Unravel-4.0-4.1_50672724.html">Unravel 4.0-4.1</a>
               </span>
            </li>

            <li class="li">
               <span class="ph">
                  <a class="xref" href="50688443.html">Installation Guide for Hortonworks Data Platform
                     (HDP)</a>
               </span>
            </li>

         </ol>
         <p class="p">Introduction</p>
         <p class="p">This guide describes how to install the Unravel Sensor for Hive Hook and Spark on HDP
            2.2.x-2.5.x clusters using <strong class="ph b">Ambari Web UI</strong> (AWU). Unravel Hive Hook is used to
            collect information about Hive queries in Hadoop. The information here applies to Hive
            versions 0.10.0 through 2.1.x and Unravel 4.0-4.1. <span class="ph">Highlighted</span> text indicates
            where you must substitute your particular values.</p>
         <p class="p">1. Start Unravel Server</p>
         <span class="ph aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span>Note: Unravel needs to be up for the next step to complete. <pre class="pre codeblock syntaxhighlighter-pre"><code>sudo /etc/init.d/unravel_all.sh start</code></pre>
         <p class="p">2. Install Unravel Hive Hook and Spark Sensor Onto HDP Servers</p>
         <p class="p">Install Unravel Hive Hook and Spark Sensor onto HDP servers (JAR files) as follows.</p>
         <pre class="pre codeblock syntaxhighlighter-pre"><code># login as root to do below steps
# ensure wget is install and use below script to install sensors 
# /usr/local/unravel/install_bin/unraveldata-clients/unravel_hdp_setup.sh 
# from Unravel server (eg. edge node)
# run on each server that will use instrumentation:
yum install -y wget
cd /usr/local/unravel/install_bin/unraveldata-clients/
sudo ./unravel_hdp_setup.sh install -y --unravel-server UNRAVEL_HOST_IP:3000 --spark-version SPARK_VERSION --hive-version HIVE_VERSION</code></pre>
         <span class="ph aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon"></span>
         <p class="p">Substitute valid values for:</p>
         <ul class="ul">

            <li class="li">
               <span class="ph">UNRAVEL_HOST_IP <span class="ph">-</span>
               </span>fully qualified host name or IP address</li>

            <li class="li">
               <span class="ph">
                  <span class="ph">
                     <span class="ph">
                        <span class="ph">SPARK_VERSION</span> - target </span>Spark version</span>
               </span>
            </li>

            <li class="li">
               <span class="ph">
                  <span class="ph">
                     <span class="ph">
                        <span class="ph">HIVE_VERSION</span> - target </span>Hive version</span>
               </span>
            </li>

         </ul>
         <span class="ph aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span>
         <p class="p">Files will be installed under:</p>
         <p class="p">Hive hook jar is located in /usr/local/unravel_client/.</p>
         <p class="p">Spark jar is located in /usr/local/unravel-spark/jars/.</p>
         <blockquote class="lq">
            <p class="p">Once the files are installed under /usr/local/unravel_client/ &amp;
               /usr/local/unravel-spark/ on edge host where Unravel rpm is installed, you can tar
               these two directories up and put on other hosts, if that is more convenient than
               running the script. In all cases, instrumented nodes must be able to open port 4043
               of Unravel Server (host2 if multi-host Unravel install).</p>
         </blockquote>
         <p class="p">3. Add Unravel Hive Hook hive-site Settings to All of HDP's Servers in the Cluster Using
            AWU</p>
         <span class="ph aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon"></span>
         <p class="p">
            <strong class="ph b">IMPORTANT:</strong> Completion of this step will require a restart of all affected Hive
            services in Ambari UI. If the env steps below are not deployed or use incorrect paths,
            then Hive jobs could fail with ClassNotFoundException when the hive-site change takes
            effect after the Hive service is restarted.</p>
         <ul class="ul">

            <li class="li">Add <code class="ph codeph">AUX_CLASSPATH</code> to AWU's <strong class="ph b">hive-env</strong> template:<ul class="ul">

                  <li class="li">In AWU, on the left-hand side, click <strong class="ph b">Hive</strong>, next click <strong class="ph b">Configs</strong>,
                     go to the <strong class="ph b">Advanced</strong> tab, and select/click <strong class="ph b">Advanced hive-env</strong>.</li>

                  <li class="li">
                     <p class="p auto-cursor-target">Next, inside the <strong class="ph b">Advanced hive-env</strong>
                        template, towards the end of line add below:</p>
                     <pre class="pre codeblock syntaxhighlighter-pre"><code>AUX_CLASSPATH=${AUX_CLASSPATH}:/usr/local/unravel_client/unravel-hive-1.2.0-hook.jar</code></pre>
                     <p class="p auto-cursor-target">
                        <em class="ph i">Hold off on restarting any services until the next step. </em>
                     </p>
                  </li>

               </ul>
            </li>

         </ul>
         <ul class="ul">

            <li class="li">Add <code class="ph codeph">HADOOP_CLASSPATH</code> to AWU's <strong class="ph b">hadoop-env</strong> template:<ul class="ul">

                  <li class="li">In AWU, on the left-hand side, click <strong class="ph b">HDFS</strong>, next click <strong class="ph b">Configs</strong>,
                     go to the <strong class="ph b">Advanced</strong> tab, and select/click <strong class="ph b">Advanced
                     hadoop-env</strong>.</li>

                  <li class="li">
                     <p class="p auto-cursor-target">Next, inside the <strong class="ph b">hadoop-env</strong>
                        template, towards the end of line add below:</p>
                     <pre class="pre codeblock syntaxhighlighter-pre"><code>HADOOP_CLASSPATH=${HADOOP_CLASSPATH}:/usr/local/unravel_client/unravel-hive-1.2.0-hook.jar</code></pre>
                     <p class="p auto-cursor-target">
                        <em class="ph i">You can optionally restart the services in Ambari, as prompted, at this
                           point in order to verify that the environment change is done correctly.
                           After the restart, look at hadoop-env.sh and hive-env.sh on an edge node
                           and check the path to the jar file. Hint: find the files with <code class="ph codeph">
                              <span class="ph s1">sudo find /etc -name '*env.sh' -newerct '1 hour
                                 ago'</span>
                           </code>
                        </em>
                     </p>
                  </li>

               </ul>
            </li>

         </ul>
         <ul class="ul">

            <li class="li">Add the contents of
               <code class="ph codeph">/usr/local/unravel/hive-hook/hive-site.xml.snip</code>  from Unravel
               Gateway server (from host2 if multi-host Unravel so you get the proper
               UNRAVEL_HOST_IP) into AWU's <strong class="ph b">Custom hive-site</strong> under <strong class="ph b">Hive</strong>:<ul class="ul">

                  <li class="li">
                     <p class="p auto-cursor-target">In AWU, on the left-hand side, click
                           <strong class="ph b">Hive</strong> | <strong class="ph b">Configs</strong>. Select the <strong class="ph b">Advanced</strong> tab, and then
                        select <strong class="ph b">Custom hive-site</strong> and <strong class="ph b">Add Property</strong> below and use <span class="ph confluence-embedded-file-wrapper confluence-embedded-manual-size">
                           <img class="image confluence-embedded-image" src="media/50689484.png" />
                        </span>
                        <strong class="ph b">Bulk property add mode.</strong>
                     </p>
                     <pre class="pre codeblock syntaxhighlighter-pre"><code>hive.exec.driver.run.hooks=com.unraveldata.dataflow.hive.hook.HiveDriverHook 
com.unraveldata.hive.hdfs.dir=/user/unravel/HOOK_RESULT_DIR 
com.unraveldata.hive.hook.tcp=true 
com.unraveldata.host=UNRAVEL_HOST_IP 
 
-- Find below properties as it may already exists, concatenate it with a comma &amp; no spaces -- 
hive.exec.pre.hooks=com.unraveldata.dataflow.hive.hook.HivePreHook 
hive.exec.post.hooks=com.unraveldata.dataflow.hive.hook.HivePostHook 
hive.exec.failure.hooks=com.unraveldata.dataflow.hive.hook.HiveFailHook</code></pre>
                     <p class="p auto-cursor-target">
                        <em class="ph i">You should restart the services in Ambari now, as prompted, to test
                           whether Hive queries can succeed after the above configuration change. If
                           you get ClassNotFoundException during a query, then make corrections or
                           revert. </em>
                     </p>
                  </li>

               </ul>
            </li>

         </ul>
         <p class="p">4. If Possible, Ensure that <strong class="ph b">hive.execution.engine</strong> is Set to
               <code class="ph codeph">MapReduce</code> in your Hive query</p>
         <pre class="pre codeblock"><code>set hive.execution.engine=mr;</code></pre>
         <p class="p">5. <strong class="ph b">Optionally for Spark on YARN</strong>, Enable Unravel Spark Instrumentation on All of
            HDP's Servers in the Cluster</p>
         <span class="ph aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon"></span>
         <strong class="ph b">IMPORTANT</strong>: Completion of this step will require a restart of all affected Spark
         services in Ambari UI.<ul class="ul">

            <li class="li">Add Spark properties into AWU's <strong class="ph b">Custom spark-defaults</strong>:<ul class="ul">

                  <li class="li">In AWU, on the left-hand side, click <strong class="ph b">Spark</strong> | <strong class="ph b">Configs</strong> | <strong class="ph b">Custom
                        spark-defaults</strong>.</li>

               </ul>
            </li>

            <li class="li">
               <p class="p">Inside <strong class="ph b">Custom spark-defaults</strong>, click <strong class="ph b">Add Property</strong> for Spark as
                  follows and use <span class="ph confluence-embedded-file-wrapper confluence-embedded-manual-size">
                     <img class="image confluence-embedded-image" src="media/50689484.png" />
                  </span> <strong class="ph b">Bulk property add mode</strong>:</p>
               <pre class="pre codeblock syntaxhighlighter-pre"><code>spark.unravel.server.hostport=UNRAVEL_HOST_IP:4043

spark.driver.extraJavaOptions=-javaagent:/usr/local/unravel-spark/jars/btrace-agent.jar=bootClassPath=/usr/local/unravel-spark/jars/unravel-boot.jar,systemClassPath=/usr/local/unravel-spark/jars/unravel-sys.jar,scriptOutputFile=/dev/null,script=DriverProbe.class:SQLProbe.class 

spark.executor.extraJavaOptions=-javaagent:/usr/local/unravel-spark/jars/btrace-agent.jar=bootClassPath=/usr/local/unravel-spark/jars/unravel-boot.jar,systemClassPath=/usr/local/unravel-spark/jars/unravel-sys.jar,scriptOutputFile=/dev/null,script=ExecutorProbe.class


spark.eventLog.enabled=true</code></pre>
               <p class="p auto-cursor-target">Notice that in this code block, the blank lines
                  separate single full lines of text that are wrapped due to length. Also, ensure
                  you replace "<span class="ph">UNRAVEL_HOST_IP" with your Unravel server's IP address.</span>
               </p>
            </li>

         </ul>
         <p class="p">6. <strong class="ph b">Optionally for MapReduce2</strong> (MR) JVM Sensor Cluster-Wide</p>
         <span class="ph aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon"></span>
         <strong class="ph b">IMPORTANT</strong>: Completion of this step will require a restart of all affected HDFS,
         MAPREDUCE2, <span class="ph">YARN and </span>HIVE services in Ambari UI.<ul class="ul">

            <li class="li">
               <p class="p auto-cursor-target">In AWU, on the left-hand
                     side, click <strong class="ph b">MapReduce2</strong>, next click <strong class="ph b">Configs</strong>, go to
                     the <strong class="ph b">Advanced</strong> tab, and select/click <strong class="ph b">Advanced mapred-site</strong>
               </p>
            </li>

            <li class="li">Search for <strong class="ph b">MR AppMaster Java Heap Size </strong>property and concatenate by copying
               and paste below code block property for
                  "<span class="ph">yarn.app.mapreduce.am.command-opts" </span>MR JVM sensor as follows:</li>

         </ul>
         <p class="p"> <em class="ph i">(Note: please leave a white space in-between the current and the following new
               property)</em>
         </p>
         <ul class="ul">

            <li class="li">
               <p class="p auto-cursor-target">On the top notification banner, click Save</p>
               <pre class="pre codeblock syntaxhighlighter-pre"><code>  -javaagent:/usr/local/unravel-spark/jars/btrace-agent.jar=systemClassPath=/usr/local/unravel-spark/jars/unravel-mr-sys.jar,bootClassPath=/usr/local/unravel-spark/jars/unravel-mr-boot.jar,scriptOutputFile=/dev/null -Dunravel.server.hostport=UNRAVEL_HOST_IP:4043 -Dcom.sun.btrace.FileClient.flush=-1</code></pre>
               <p class="p auto-cursor-target">Notice that in this code block, the blank lines
                  separate single full lines of text that are wrapped due to length. Also, ensure
                  you replace "<span class="ph">
                     <span class="ph">UNRAVEL_HOST_IP</span>" with your Unravel server's IP address.</span>
               </p>
               <p class="p auto-cursor-target">
                  <span class="ph"></span>
               </p>
            </li>

            <li class="li">
               <p class="p auto-cursor-target">In AWU, on the left-hand side, click
                     <strong class="ph b">MapReduce2</strong>, next click <strong class="ph b">Configs</strong>, go to the <strong class="ph b">Advanced</strong> tab,
                  and select/click <strong class="ph b">Custom mapred-site:</strong>
               </p>
            </li>

         </ul>
         <ul class="ul">

            <li class="li">Inside <strong class="ph b">Custom </strong>
               <strong class="ph b">mapred-site</strong>, click <strong class="ph b">Add Property</strong> for MR JVM sensor as follows and
                  use <span class="ph confluence-embedded-file-wrapper confluence-embedded-manual-size">
                  <img class="image confluence-embedded-image" src="media/50689484.png" />
               </span>
               <strong class="ph b">Bulk property add mode</strong>:</li>

            <li class="li">
               <p class="p auto-cursor-target">On the top notification banner, click Save</p>
               <pre class="pre codeblock syntaxhighlighter-pre"><code>mapreduce.task.profile=true
mapreduce.task.profile.maps=0-5
mapreduce.task.profile.reduces=0-5
mapreduce.task.profile.params=-javaagent:/usr/local/unravel-spark/jars/btrace-agent.jar=systemClassPath=/usr/local/unravel-spark/jars/unravel-mr-sys.jar,bootClassPath=/usr/local/unravel-spark/jars/unravel-mr-boot.jar,scriptOutputFile=/dev/null -Dunravel.server.hostport=UNRAVEL_HOST_IP:4043 -Dcom.sun.btrace.FileClient.flush=-1</code></pre>
               <p class="p auto-cursor-target">Notice that in this code block, the blank lines
                  separate single full lines of text that are wrapped due to length. Also, ensure
                  you replace "<span class="ph">
                     <span class="ph">UNRAVEL_HOST_IP</span>" with your Unravel server's IP address.</span>
               </p>
            </li>

            <li class="li">
               <p class="p">
                  <span class="ph">Following instructions are for Unravel rpm 4.0.x and 4.1.x</span>
               </p>
               <p class="p auto-cursor-target">
                  <span class="ph">Please propagate Unravel MR jar </span>
                  <span class="ph">onto all the servers in the cluster </span>as follows<strong class="ph b">:</strong>
               </p>
               <span class="ph aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span>Ensure you have already installed unzip, curl, and Unravel port# 3000 must be open<ul class="ul">

                  <li class="li">
                     <p class="p auto-cursor-target">ssh to the Unravel gateway host server and
                        use guided steps to unzip the Unravel MR jars.</p>
                     <ul class="ul">

                        <li class="li">
                           <p class="p auto-cursor-target">With root or sudo access, change
                              directory to /usr/local/unravel-spark and run the below curl get
                              command:</p>
                           <pre class="pre codeblock syntaxhighlighter-pre"><code>cd /usr/local/unravel-spark
curl http://localhost:3000/hh/unravel-sensor-for-mapreduce-bin.zip -o unravel-sensor-for-mapreduce-bin.zip
unzip -d jars unravel-sensor-for-mapreduce-bin.zip</code></pre>
                        </li>

                        <li class="li">
                           <p class="p auto-cursor-target">Now, tar up the
                              /usr/local/unravel-spark directory, and propagate to all the servers
                              in the HDP cluster</p>
                           <pre class="pre codeblock syntaxhighlighter-pre"><code>cd /usr/local/
tar -cvf unravel-spark.tar  ./unravel-spark
---&gt; copy the unravel-spark.tar file to all your servers, and untar to /usr/local directory because when you untar unravel-spark directory will appear</code></pre>
                        </li>

                     </ul>
                     <p class="p auto-cursor-target">
                        <span class="ph"></span>
                     </p>
                  </li>

               </ul>
            </li>

         </ul>
         <p class="p">Attachments:</p>
         <img class="image" src="images/icons/bullet_blue.gif" alt="" />
         <a class="xref" href="media/logo.png">worddav95f1e8fd13958fae391afc8e6f9ad03d.png</a> (image/png) 
         <br /><img class="image" src="images/icons/bullet_blue.gif" alt="" /><br />
         <a class="xref" href="media/50689484.png">worddav0175c0ac4efc905578b516dee96677a5.png</a> (image/png) 
         <br /><img class="image" src="images/icons/bullet_blue.gif" alt="" /><br />
         <a class="xref" href="media/51089825.png">logo_small.png</a> (image/png)
         
      </section>
   </div>
</article></main></div>
                        
                        
                        <!--
    
Oxygen WebHelp Plugin
Copyright (c) 1998-2018 Syncro Soft SRL, Romania.  All rights reserved.

--><div id="wh_feedback">
    <div id="cmts"><!----></div>
    
    <script type="text/javascript" src="./oxygen-webhelp/feedback/config/config.js"><!----></script>
    <script type="text/javascript" src="./oxygen-webhelp/feedback/resources/js/parseuri.js"><!----></script>
    <script type="text/javascript" src="./oxygen-webhelp/feedback/resources/localization/strings.js"><!----></script>
    <script type="text/javascript" src="./oxygen-webhelp/feedback/resources/js/init.js"><!----></script>
    <script type="text/javascript">
        function showCommentsFor(page) {
           console.log('showCommentsFor(' + page + ')');
           init(page, $('#cmts'));
           
           return false;
        }
        
        var pageLocation = window.location.href;
        try {
            var p = parseUri(pageLocation);
            console.log(p);
            showCommentsFor(p.path);
        } catch (e) {
            debug(e);
        }
    </script>
</div>
                    </div>
                    
                </div>
            </div>
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container text-center ">
    Generated by <a class="oxyFooter" href="http://www.oxygenxml.com/xml_webhelp.html" target="_blank">&lt;oXygen/&gt; XML WebHelp</a> - Trial Edition
  </div>
</footer>
        
        <div id="go2top">
            <span class="glyphicon glyphicon-chevron-up"></span>
        </div>
        
        <!-- The modal container for images -->
        <div id="modal_img_large" class="modal">
            <span class="close glyphicon glyphicon-remove"></span>
            <!-- Modal Content (The Image) -->
            <img class="modal-content" id="modal-img" />
            <!-- Modal Caption (Image Text) -->
            <div id="caption"></div>
        </div>
        
        <script src="./oxygen-webhelp/lib/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
        
    </body>
</html>