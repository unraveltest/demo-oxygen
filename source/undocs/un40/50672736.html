<!DOCTYPE html>
<html>
    <head>
        <title>Unravel 4.0-4.1 : Part 1: Install Unravel Server on HDP</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />

    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Unravel 4.0-4.1</a></span>
                            </li>
                                                    <li>
                                <span><a href="Unravel-4.0-4.1_50672724.html">Unravel 4.0-4.1</a></span>
                            </li>
                                                    <li>
                                <span><a href="50688443.html">Installation Guide for Hortonworks Data Platform (HDP)</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                           Part 1: Install Unravel Server on HDP
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Paul Baclace</span>, last modified by <span class='editor'> Ada-C</span> on Aug 18, 2017
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h2 id="Part1:InstallUnravelServeronHDP-Introduction">Introduction</h2><p style="text-align: left;">This topic explains how to <span>deploy Unravel Server 4.0-4.1 on HDP 2.2.x-2.5.x clusters using Ambari Web UI (AWU). Unravel Hive Hook is used to collect information about Hive queries in Hadoop. The information here applies to Hive versions 0.10.0 through 2.1.x and Unravel 4.0-4.1</span>. For older versions of Unravel Server, contact Unravel Support.</p><p><br/></p><div class="panel" style="border-color: #94BEE5;border-style: dotted;border-width: 1px;"><div class="panelHeader" style="border-bottom-width: 1px;border-bottom-style: dotted;border-bottom-color: #94BEE5;background-color: #94BEE5;"><b>Workflow Summary</b></div><div class="panelContent">
<ol><li>Pre-installation check</li><li>Configure the host machine.</li><li>Install the Unravel Server RPM on the host machine.</li><li><p>Configure Unravel Server (basic/core options).</p></li><li>Log into Unravel Web UI.</li><li>(Optional) Configure Unravel Server (advanced options).</li></ol>
</div></div><div class="panel" style="border-color: #94BEE5;border-style: dotted;border-width: 1px;"><div class="panelHeader" style="border-bottom-width: 1px;border-bottom-style: dotted;border-bottom-color: #94BEE5;background-color: #94BEE5;"><b>Table of Contents</b></div><div class="panelContent">

<ul class='toc-indentation'>
<li><a href='#Part1:InstallUnravelServeronHDP-Introduction'>Introduction</a></li>
<li><a href='#Part1:InstallUnravelServeronHDP-Pre-InstallationCheck'>Pre-Installation Check</a>
<ul class='toc-indentation'>
<li><a href='#Part1:InstallUnravelServeronHDP-PlatformCompatibility'>Platform Compatibility</a></li>
<li><a href='#Part1:InstallUnravelServeronHDP-Hardware'>Hardware</a></li>
<li><a href='#Part1:InstallUnravelServeronHDP-Software'>Software</a></li>
<li><a href='#Part1:InstallUnravelServeronHDP-AccessPermissions'>Access Permissions</a></li>
<li><a href='#Part1:InstallUnravelServeronHDP-Network'>Network</a></li>
</ul>
</li>
<li><a href='#Part1:InstallUnravelServeronHDP-1.ConfiguretheHostMachine'>1. Configure the Host Machine</a>
<ul class='toc-indentation'>
<li><a href='#Part1:InstallUnravelServeronHDP-AllocateaClusterGateway/Edge/ClientHostwithHDFSAccess'>Allocate a Cluster Gateway/Edge/Client Host with HDFS Access</a></li>
</ul>
</li>
<li><a href='#Part1:InstallUnravelServeronHDP-2.InstalltheUnravelServerRPMontheHostMachine'>2. Install the Unravel Server RPM on the Host Machine</a>
<ul class='toc-indentation'>
<li><a href='#Part1:InstallUnravelServeronHDP-GettheUnravelServerRPM'>Get the Unravel Server RPM</a></li>
<li><a href='#Part1:InstallUnravelServeronHDP-InstalltheUnravelServerRPM'>Install the Unravel Server RPM</a></li>
<li><a href='#Part1:InstallUnravelServeronHDP-DoHost-SpecificPost-InstallationActions'>Do Host-Specific Post-Installation Actions</a></li>
</ul>
</li>
<li><a href='#Part1:InstallUnravelServeronHDP-3.ConfigureUnravelServer(Basic/CoreOptions)'>3. Configure Unravel Server (Basic/Core Options)</a>
<ul class='toc-indentation'>
<li><a href='#Part1:InstallUnravelServeronHDP-Modifyunravel.properties'>Modify unravel.properties</a></li>
<li><a href='#Part1:InstallUnravelServeronHDP-IfKerberosisEnabled:'>If Kerberos is Enabled:</a></li>
<li><a href='#Part1:InstallUnravelServeronHDP-IfRangerisEnabled:'>If Ranger is Enabled:</a></li>
</ul>
</li>
<li><a href='#Part1:InstallUnravelServeronHDP-4.ConvertYourUnravelInstallationtoHDP'>4. Convert Your Unravel Installation to HDP</a></li>
<li><a href='#Part1:InstallUnravelServeronHDP-5.UpdateSite-SpecificHDPProperties'>5. Update Site-Specific HDP Properties</a>
<ul class='toc-indentation'>
<li><a href='#Part1:InstallUnravelServeronHDP-RestartUnravelServer'>Restart Unravel Server</a></li>
</ul>
</li>
<li><a href='#Part1:InstallUnravelServeronHDP-4.LogintoUnravelWebUI'>4. Log into Unravel Web UI</a>
<ul class='toc-indentation'>
<li><a href='#Part1:InstallUnravelServeronHDP-Congratulations!'>Congratulations!</a></li>
</ul>
</li>
<li><a href='#Part1:InstallUnravelServeronHDP-5.(Optional)ConfigureUnravelServer(AdvancedOptions)'>5. (Optional) Configure Unravel Server (Advanced Options)</a>
<ul class='toc-indentation'>
<li><a href='#Part1:InstallUnravelServeronHDP-EnableAdditionalDataCollection/Instrumentation'>Enable Additional Data Collection/Instrumentation</a></li>
<li><a href='#Part1:InstallUnravelServeronHDP-RuntheUnravelWebUIConfigurationWizard'>Run the Unravel Web UI Configuration Wizard</a></li>
</ul>
</li>
</ul>

</div></div><h2 id="Part1:InstallUnravelServeronHDP-Pre-InstallationCheck">Pre-Installation Check</h2><p>The following installation requirements must be met for successful installation of Unravel.</p><h3 id="Part1:InstallUnravelServeronHDP-PlatformCompatibility">Platform Compatibility</h3><ul><li>HDP 2.2-2.6</li><li>Hadoop 1.x - 2.x</li><li>Hive 0.9.x - 1.2.x</li><li>Spark 1.3.x - 2.0.x</li></ul><h3 id="Part1:InstallUnravelServeronHDP-Hardware">Hardware</h3><ul><li>Architecture: x86_64</li><li>Cores: 8</li><li>RAM: 64GB minimum</li><li>Disk: <code>/usr/local/unravel</code> with 2.5GB free minimum</li><li>Disk: <code>/srv/unravel</code> with 500GB free minimum</li><li>For 10,000+ MR jobs per day, two or more gateway/edge nodes are recommended</li></ul><h3 id="Part1:InstallUnravelServeronHDP-Software">Software</h3><ul><li>Operating System: RedHat/Centos 6.4 - 7.3</li><li><code>libaio.x86_64</code> installed</li><li><code>SELINUX=permissive</code> (or disabled) should be set in <code>/etc/selinux/config</code></li><li>HDFS+Hive+YARN client/gateway, Hadoop and Hive commands in <code>PATH</code></li><li>If Spark is in use, Spark client gateway</li><li>LDAP (AD or Open LDAP) compatible for Unravel Web UI user authentication (Open signup by default)</li><li>On Unravel Edge-node server, please <strong><u>do not</u></strong> have zookeeper installed in same server</li></ul><h3 id="Part1:InstallUnravelServeronHDP-AccessPermissions">Access Permissions</h3><ul><li>If Kerberos is in use, a keytab for principal hdfs (or read-only equivalent) is required for access to:<ul><li>Access to YARN’s “done dir” in HDFS</li><li>Access to YARN’s log aggregation directory in HDFS</li><li>Access to Spark event log directory in HDFS</li><li>Access to file sizes under HIve warehouse directory</li></ul></li><li>Access to YARN Resource Manager REST API<br/><ul><li>principal needs right to find out which RM is active</li></ul></li><li>JDBC access to the Hive Metastore (read-only user is sufficient)</li></ul><h3 id="Part1:InstallUnravelServeronHDP-Network">Network</h3><ul><li>Port 3000 (or 4020) from users and entire cluster to Unravel Web UI</li><li>HDFS ports open from Hadoop cluster to Unravel Server(s)</li><li>For MR1, TaskTracker port open from Hadoop cluster to Unravel Server(s)</li><li>For MR1/YARN, Hive Metadata DB port open to Unravel Server(s) for partition reporting</li><li>UDP and TCP port 4043 open from entire cluster to Unravel Server(s)</li><li>For Oozie, port 11000 open from Unravel Server(s) to the Oozie server</li><li>Resource Manager (RM) port 8032 from Unravel Server(s) to the RM server(s)</li><li><span>Port 4176, 4181 through 4189, 3316, 4091 must be available for localhost communication between Unravel daemons or services</span></li></ul><h2 id="Part1:InstallUnravelServeronHDP-1.ConfiguretheHostMachine">1. Configure the Host Machine</h2><h3 id="Part1:InstallUnravelServeronHDP-AllocateaClusterGateway/Edge/ClientHostwithHDFSAccess">Allocate a Cluster Gateway/Edge/Client Host with HDFS Access</h3><p>For HDP, use Ambari Web UI to create a Gateway node configuration. The hadoop command must be present on the Unravel target server.</p><h2 id="Part1:InstallUnravelServeronHDP-2.InstalltheUnravelServerRPMontheHostMachine">2. Install the Unravel Server RPM on the Host Machine</h2><h3 id="Part1:InstallUnravelServeronHDP-GettheUnravelServerRPM">Get the Unravel Server RPM</h3><p>Copy the RPM from the Unravel distribution server to the host machine using the username and password given to you by Unravel Support:</p><ul><li><p class="auto-cursor-target">For the free trial version:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">scp &quot;unraveltrial@trial.unraveldata.com:unravel-4.*.x86_64.rpm&quot; .</pre>
</div></div></li><li>For the enterprise version:<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">scp $USER@dist.unraveldata.com:unravel-4.*.x86_64.rpm.$timestamp .</pre>
</div></div></li></ul><p>The precise RPM filename will vary. The version has the structure <em><code>x.y.b</code></em> where <em><code>b</code></em> is a build number that is imposed as an RPM epoch which means it takes precedence over version numbers for determining what is more up-to-date. The Unravel build numbers always increase and are allocated so that they respect the ordering of <em><code>x.y</code></em> versioning.</p><p><br/></p><h3 id="Part1:InstallUnravelServeronHDP-InstalltheUnravelServerRPM">Install the Unravel Server RPM</h3><p>Replace the asterisks as needed to be more selective.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">sudo rpm -U unravel-4.*.x86_64.rpm*</pre>
</div></div><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>The installation creates <code>/usr/local/unravel/</code> which contains the executables, scripts, and settings. User <code>unravel</code> is created. The initial internal database and other durable state are put in <code>/srv/unravel/</code> for larger storage. By default, the installation supports YARN. <br class="atl-forced-newline"/><br class="atl-forced-newline"/> The master configuration file is in <code>/usr/local/unravel/etc/unravel.properties</code> and the logs are in <code>/usr/local/unravel/logs/</code>. The RPM installation creates user <code>unravel</code> if it does not already exist; <code>/etc/init.d/unravel_*</code> scripts for controlling its services as well as <code>/etc/init.d/unravel_all.sh</code> which can be used to manually stop, start, and get status of all daemons in proper order. <br class="atl-forced-newline"/><br class="atl-forced-newline"/> The RPM installation also creates an HDFS directory for Hive Hook information collection. <br class="atl-forced-newline"/><br class="atl-forced-newline"/> During initial install, a bundled database is used. This can be switched to use an externally managed MySQL for production. (The bundled database root mysql password will be stored in <code>/root/unravel.install.include</code> during installation.)</p></div></div><p><br/></p><h3 id="Part1:InstallUnravelServeronHDP-DoHost-SpecificPost-InstallationActions"><span style="color: rgb(0,0,0);">Do Host-Specific Post-Installation Actions</span></h3><p><span style="color: rgb(0,0,0);">For HDP, there are no host-specific post-installation actions.<br/></span></p><h2 id="Part1:InstallUnravelServeronHDP-3.ConfigureUnravelServer(Basic/CoreOptions)">3. Configure Unravel Server (Basic/Core Options)</h2><h3 id="Part1:InstallUnravelServeronHDP-Modifyunravel.properties">Modify <code>unravel.properties</code></h3><ul><li><p>Open <span style="color: rgb(0,0,0);"><code>/usr/local/unravel/etc/unravel.properties</code></span> with <code>vi</code>.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">sudo vi /usr/local/unravel/etc/unravel.properties</pre>
</div></div></li><li>Edit the values in <span style="color: rgb(0,0,0);"><code>unravel.properties</code></span> using the guidelines and descriptions in the table below.</li></ul><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col style="width: 441.0px;"/><col style="width: 437.0px;"/><col style="width: 744.0px;"/></colgroup><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Description</th><th class="confluenceTh">Example</th></tr><tr><td colspan="1" class="confluenceTd"><code>com.unraveldata.advertised.url</code></td><td colspan="1" class="confluenceTd">Defines the Unravel Server URL for HTTP traffic.</td><td colspan="1" class="confluenceTd"><code>com.unraveldata.advertised.url=<span class="nolink"><span class="nolink">http://<span style="color: rgb(255,0,0);">LAN_DNS</span>:3000</span></span></code></td></tr><tr><td colspan="1" class="confluenceTd"><code>com.unraveldata.customer.organization</code></td><td colspan="1" class="confluenceTd">Identifies your installation for reporting purposes.</td><td colspan="1" class="confluenceTd"><code>com.unraveldata.customer.organization=<span style="color: rgb(255,0,0);">Company_and_org</span></code></td></tr><tr><td colspan="1" class="confluenceTd"><pre>com.unraveldata.tmpdir</pre></td><td colspan="1" class="confluenceTd">Location where Unravel's temp file will reside</td><td colspan="1" class="confluenceTd"><pre>com.unraveldata.tmpdir=/srv/unravel/tmp</pre></td></tr><tr><td colspan="1" class="confluenceTd"><code>com.unraveldata.history.maxSize.weeks</code></td><td colspan="1" class="confluenceTd">Sets retention for search data.</td><td colspan="1" class="confluenceTd"><code>com.unraveldata.history.maxSize.weeks=26</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>com.unraveldata.hive.hook.topic.num.threads</code></td><td colspan="1" class="confluenceTd"><strong>Optional</strong>. Defines the number of threads. Default is 1. Depending on job volume, increase this property to <em>N</em> where <em>N</em> is between 1 and 4, or roughly <em>ThousandJobsPerDay</em>/10.</td><td colspan="1" class="confluenceTd"><code>com.unraveldata.hive.hook.topic.num.threads=1</code></td></tr><tr><td class="confluenceTd"><code><span style="color: rgb(0,0,0);">com.unraveldata.job.collector.done.log.base</span></code></td><td class="confluenceTd">Only modifiable through Unravel Web UI's configuration wizard.</td><td class="confluenceTd"><pre>com.unraveldata.job.collector.done.log.base=/mr-history/done</pre></td></tr><tr><td class="confluenceTd"><code><span style="color: rgb(0,0,0);"><span><code>com.unraveldata.job.collector.log.aggregation.base</code></span></span></code></td><td class="confluenceTd">Only modifiable through Unravel Web UI's configuration wizard.</td><td class="confluenceTd"><pre>com.unraveldata.job.collector.log.aggregation.base=/app-logs/*/logs/</pre></td></tr><tr><td colspan="1" class="confluenceTd"><code>com.unraveldata.login.admins</code></td><td colspan="1" class="confluenceTd">Defines the usernames that can access Unravel Web UI's admin pages. Default is <code>admin</code>.</td><td colspan="1" class="confluenceTd"><code>com.unraveldata.login.admins=admin</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>com.unraveldata.s3.batch.monitoring.interval.sec</code></td><td colspan="1" class="confluenceTd"><strong>Optional</strong>. Defines the monitoring frequency. Default is 300 seconds (5 minutes). Set this property to 60 for lower latency.</td><td colspan="1" class="confluenceTd"><code>com.unraveldata.s3.batch.monitoring.interval.sec=120</code></td></tr><tr><td class="confluenceTd"><code><span style="color: rgb(0,0,0);">com.unraveldata.spark.eventlog.location</span></code><span><br/></span></td><td class="confluenceTd"><span>Where to find Spark event logs</span></td><td class="confluenceTd"><pre>com.unraveldata.spark.eventlog.location=hdfs://example.localdomain:8020/spark-history/</pre></td></tr><tr><td colspan="1" class="confluenceTd"><code><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);text-decoration: none;">yarn.resourcemanager.webapp.address</span></span></code></td><td colspan="1" class="confluenceTd"><span>YARN resource manager web address URL </span></td><td colspan="1" class="confluenceTd"><pre>yarn.resourcemanager.webapp.address=http://example.localdomain<a href="http://ip-10-0-0-90.ec2.internal:8088" class="external-link" rel="nofollow">:8088</a></pre></td></tr><tr><td colspan="1" class="confluenceTd"><code><span style="color: rgb(0,0,0);">oozie.server.url</span></code></td><td colspan="1" class="confluenceTd">Oozie URL</td><td colspan="1" class="confluenceTd"><pre>oozie.server.url=http://example.localdomain<a class="external-link" href="http://ip-10-0-0-90.ec2.internal:11000/oozie" rel="nofollow">:11000/oozie</a></pre></td></tr></tbody></table></div><h3 id="Part1:InstallUnravelServeronHDP-IfKerberosisEnabled:">If Kerberos is Enabled:</h3><div id="expander-1699665928" class="expand-container"><div id="expander-control-1699665928" class="expand-control"><span class="expand-control-icon"><img style="vertical-align:middle;" class="expand-control-image" src="images/icons/grey_arrow_down.png"></img></span><span class="expand-control-text">Add authentication for HDFS...</span></div><div id="expander-content-1699665928" class="expand-content"><p>(a) Create a keytab for unravel for daemons that run as <code>unravel</code> and put the file in <code>/etc/keytabs/unravel.keytab</code> (for example).</p><p>(b) Create a keytab for hdfs for the Unravel daemons that run as user <code>hdfs</code> and put the file in <code>/etc/keytabs/hdfs.keytab</code> (for example).</p><p>(c) Tell Unravel Server about it (env var for hdfs keytab location; substitute correct realm and /hostname, if applicable):</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">echo &quot;export HDFS_KEYTAB_PATH=/etc/keytabs/hdfs.keytab 
export HDFS_KERBEROS_PRINCIPAL=hdfs/myhost.mydomain@MYREALM 
&quot; | sudo tee -a /usr/local/unravel/etc/unravel.ext.sh </pre>
</div></div><p>(d) Add properties for Kerberos:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">echo &quot;
com.unraveldata.kerberos.principal=unravel/myhost.mydomain@MYREALM
com.unraveldata.kerberos.keytab.path=/etc/keytabs/unravel.keytab
&quot; | sudo tee -a /usr/local/unravel/unravel.properties

</pre>
</div></div><p class="auto-cursor-target"><em>You can find the principal by using 'klist -kt KEYTAB_FILE'</em></p></div></div><h3 id="Part1:InstallUnravelServeronHDP-IfRangerisEnabled:">If Ranger is Enabled:</h3><div id="expander-750080208" class="expand-container"><div id="expander-control-750080208" class="expand-control"><span class="expand-control-icon"><img style="vertical-align:middle;" class="expand-control-image" src="images/icons/grey_arrow_down.png"></img></span><span class="expand-control-text">Add these permissions...</span></div><div id="expander-content-750080208" class="expand-content"><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/><col/></colgroup><tbody><tr><th class="confluenceTh">Resource</th><th class="confluenceTh">Principal</th><th class="confluenceTh">Access</th><th colspan="1" class="confluenceTh">Purpose</th></tr><tr><td class="confluenceTd"><code>hdfs://user/unravel/HOOK_RESULT_DIR</code></td><td class="confluenceTd">*</td><td class="confluenceTd">read+write</td><td colspan="1" class="confluenceTd">data transfer from Hive jobs when Unravel is not up</td></tr><tr><td colspan="1" class="confluenceTd"><code><span>hdfs://user/spark/applicationHistory</span></code></td><td colspan="1" class="confluenceTd">hdfs</td><td colspan="1" class="confluenceTd"><span>read</span></td><td colspan="1" class="confluenceTd">Spark event log</td></tr><tr><td colspan="1" class="confluenceTd"><code><span>hdfs://usr/history/done</span></code></td><td colspan="1" class="confluenceTd"><span>hdfs</span></td><td colspan="1" class="confluenceTd"><span>read</span></td><td colspan="1" class="confluenceTd">MapReduce logs</td></tr><tr><td colspan="1" class="confluenceTd"><code><span>hdfs://tmp/logs</span></code></td><td colspan="1" class="confluenceTd"><span>hdfs</span></td><td colspan="1" class="confluenceTd"><span>read</span></td><td colspan="1" class="confluenceTd">YARN aggregation folder</td></tr><tr><td colspan="1" class="confluenceTd"><code><span>hdfs://user/hive/warehouse</span></code></td><td colspan="1" class="confluenceTd"><span>hdfs</span></td><td colspan="1" class="confluenceTd"><span>read</span></td><td colspan="1" class="confluenceTd">Obtain table partition sizes</td></tr><tr><td colspan="1" class="confluenceTd">Hive Metastore GRANT</td><td colspan="1" class="confluenceTd">hive</td><td colspan="1" class="confluenceTd"><span>read</span></td><td colspan="1" class="confluenceTd">Hive table information</td></tr></tbody></table></div></div></div><p><br/></p><p><br/></p><h2 id="Part1:InstallUnravelServeronHDP-4.ConvertYourUnravelInstallationtoHDP">4. Convert Your Unravel Installation to HDP</h2><p>Run the following commands on Unravel Server:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">sudo /etc/init.d/unravel_all.sh stop
sudo /usr/local/unravel/install_bin/switch_to_hdp.sh</pre>
</div></div><p><br/></p><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body">Note: This change will stick after RPM upgrades.</div></div><h2 id="Part1:InstallUnravelServeronHDP-5.UpdateSite-SpecificHDPProperties">5. Update Site-Specific HDP Properties</h2><p>The following site-specific properties in <code>/usr/local/unravel/etc/unravel.properties</code> were added or modified by the script above (<code>switch_to_hdp.sh</code>). Check <code>/usr/local/unravel/etc/unravel.properties</code> to see if you need to modify any of these properties:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence"># Repoint Unravel application logs directory
com.unraveldata.job.collector.done.log.base=/mr-history/done
com.unraveldata.job.collector.log.aggregation.base=/app-logs/*/logs/
com.unraveldata.spark.eventlog.location=hdfs:///user/spark/applicationHistory/
 
# Add Hive Metastore database information for Unravel Hive Config 
javax.jdo.option.ConnectionURL=jdbc:mysql://{hostname}:3306/{database_name} 
javax.jdo.option.ConnectionDriverName=com.mysql.jdbc.Driver
javax.jdo.option.ConnectionUserName={HiveMetastoreUserName} 
javax.jdo.option.ConnectionPassword={HiveMetastorePassword}</pre>
</div></div><p><br/></p><p>Verify above site-specific values using the Ambari Web UI (AWU):</p><ul><li>Verify <code>com.unraveldata.job.collector.done.log.base</code><ul><li><span style="color: rgb(51,51,51);">In AWU, on the left-hand side, click <strong>MapReduce2</strong> | <strong>Configs</strong>. Select the <strong>Advanced</strong> tab, and then select </span><strong>Advanced mapred-site</strong>.<ul><li><span style="color: rgb(51,51,51);">Take note of the value of <code>mapreduce.jobhistory.done-dir</code> to enter into <code>unravel.properties</code> of &quot;<code>com.unraveldata.job.collector.done.log.base=</code>&quot;</span></li></ul></li></ul></li><li>Verify <code>com.unraveldata.job.collector.log.aggregation.base</code><ul><li><span style="color: rgb(51,51,51);">In AWU, on the left-hand side, click <strong>YARN</strong> | <strong>Configs</strong>. Select the <strong>Advanced</strong> tab, and then select </span><strong>Node Manager</strong>.<ul><li><span style="color: rgb(51,51,51);">Take note of the value of <code>yarn.nodemanager.remote-app-log-dir</code> to enter into <code>unravel.properties</code> of &quot;<code>com.unraveldata.job.collector.log.aggregation.base=</code>&quot;</span></li></ul></li></ul></li><li>Verify Hive Metastore <code>javax.jdo.option.Connection</code><ul><li><span style="color: rgb(51,51,51);">In AWU, on the left-hand side, click <strong>Hive</strong> | <span style="color: rgb(51,51,51);"><strong>Configs</strong>. Select the <strong>Advanced</strong> tab</span>, and then select </span><strong>Hive Metastore</strong>.<br/><ul><li><span style="color: rgb(51,51,51);">Take note of following properties and their values to be entered into <code>unravel.properties</code>:</span><ul><li><strong><span style="color: rgb(51,51,51);">Database URL</span></strong></li><li><strong><span style="color: rgb(51,51,51);">Database Host</span></strong></li><li><strong><span style="color: rgb(51,51,51);">JDBC Driver Class</span></strong></li><li><strong><span style="color: rgb(51,51,51);">Database Name</span></strong></li><li><strong><span style="color: rgb(51,51,51);">Database Username</span></strong></li><li><span style="color: rgb(51,51,51);"><strong>Database Password</strong> (if visible)</span></li></ul></li></ul></li></ul></li></ul><p><br/></p><h3 id="Part1:InstallUnravelServeronHDP-RestartUnravelServer">Restart Unravel Server</h3><p>After edits to <code>com.unraveldata.login.admins</code> in <code>/usr/local/unravel/etc/unravel.properties</code> it is necessary to run the following script in order to make changes take effect. The <code>echo</code> command shows the page to visit with your browser. If you are using an ssh tunnel or http proxy, you might need to make adjustments.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">sudo /etc/init.d/unravel_all.sh start
sleep 60
echo &quot;http://$(hostname -f):3000/&quot;</pre>
</div></div><p>This completes the basic/core configuration.</p><h2 id="Part1:InstallUnravelServeronHDP-4.LogintoUnravelWebUI">4. Log into Unravel Web UI</h2><p style="text-align: left;">Using a web browser, navigate to <code><span class="nolink">http://($hostname</span> -f):3000</code> and login as user &quot;<code>admin&quot;</code> with password <code>&quot;unraveldata</code>&quot;.</p><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>For the free trial version, use the Chrome web browser.</p></div></div><p style="text-align: left;"><span class="confluence-embedded-file-wrapper image-center-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image image-center" height="250" src="media/51099949.png" data-image-src="media/51099949.png" data-unresolved-comment-count="0" data-linked-resource-id="51099949" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2017-2-26_0-20-12.png" data-base-url="https://unraveldata.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="50672736" data-linked-resource-container-version="54" data-media-id="d610ec8b-6b75-40ae-9c2b-5fe46121c797" data-media-type="file"></img></span></p><p style="text-align: center;"><em>Unravel Web UI Login Screen</em></p><h3 id="Part1:InstallUnravelServeronHDP-Congratulations!">Congratulations!</h3><p>Unravel Server is up and running. Unravel Web UI displays collected data. For instructions on using Unravel Web UI, see the <a href="User-Guide_50687944.html" data-linked-resource-id="50687944" data-linked-resource-version="49" data-linked-resource-type="page">User Guide</a>.</p><h2 id="Part1:InstallUnravelServeronHDP-5.(Optional)ConfigureUnravelServer(AdvancedOptions)">5. (Optional) Configure Unravel Server (Advanced Options)</h2><h3 id="Part1:InstallUnravelServeronHDP-EnableAdditionalDataCollection/Instrumentation">Enable Additional Data Collection/Instrumentation</h3><p>Install the Unravel Sensor Parcel on gateway/edge/client nodes that are used to submit Hive queries to push additional information to Unravel Server. For details, see <a href="50689477.html" data-linked-resource-id="50689477" data-linked-resource-version="74" data-linked-resource-type="page">Part 2: Enable Additional Data Collection / Instrumentation for HDP</a>.</p><h3 id="Part1:InstallUnravelServeronHDP-RuntheUnravelWebUIConfigurationWizard">Run the Unravel Web UI Configuration Wizard</h3><p>Run the Unravel Web UI configuration wizard to choose additional configuration options. For instructions on configuring advanced options, see the <a href="User-Guide_50687944.html" data-linked-resource-id="50687944" data-linked-resource-version="49" data-linked-resource-type="page">User Guide</a>.</p><p><br/></p><pre>
</pre>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="media/51099945.png">logo_small.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="media/51099949.png">image2017-2-26_0-20-12.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Jan 25, 2019 23:02</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
